From 8970c8040a87bb9da1d22cabfd5dafb79924ed1f Mon Sep 17 00:00:00 2001
From: File <noreply+automated@papermc.io>
Date: Sun, 20 Apr 1997 06:37:42 -0700
Subject: [PATCH] paper File Patches


diff --git a/net/minecraft/world/item/ThrowablePotionItem.java b/net/minecraft/world/item/ThrowablePotionItem.java
index 0aaf59d84b0f37d86168432a221b67372aadd95f..86198fb3150409b4b3e123982d8d3ba40b774621 100644
--- a/net/minecraft/world/item/ThrowablePotionItem.java
+++ b/net/minecraft/world/item/ThrowablePotionItem.java
@@ -23,11 +23,24 @@ public abstract class ThrowablePotionItem extends PotionItem implements Projecti
     public InteractionResult use(Level level, Player player, InteractionHand hand) {
         ItemStack itemInHand = player.getItemInHand(hand);
         if (level instanceof ServerLevel serverLevel) {
-            Projectile.spawnProjectileFromRotation(this::createPotion, serverLevel, itemInHand, player, -20.0F, PROJECTILE_SHOOT_POWER, 1.0F);
+            // Paper start - PlayerLaunchProjectileEvent
+            final Projectile.Delayed<AbstractThrownPotion> thrownPotion = Projectile.spawnProjectileFromRotationDelayed(this::createPotion, serverLevel, itemInHand, player, -20.0F, PROJECTILE_SHOOT_POWER, 1.0F);
+            com.destroystokyo.paper.event.player.PlayerLaunchProjectileEvent event = new com.destroystokyo.paper.event.player.PlayerLaunchProjectileEvent((org.bukkit.entity.Player) player.getBukkitEntity(), org.bukkit.craftbukkit.inventory.CraftItemStack.asCraftMirror(itemInHand), (org.bukkit.entity.Projectile) thrownPotion.projectile().getBukkitEntity());
+            if (event.callEvent() && thrownPotion.attemptSpawn()) {
+                if (event.shouldConsume()) {
+                    itemInHand.consume(1, player);
+                } else {
+                    player.containerMenu.sendAllDataToRemote();
+                }
+            } else {
+                player.containerMenu.sendAllDataToRemote();
+                return InteractionResult.FAIL;
+            }
+            // Paper end - PlayerLaunchProjectileEvent
         }
 
         player.awardStat(Stats.ITEM_USED.get(this));
-        itemInHand.consume(1, player);
+        // Paper - PlayerLaunchProjectileEvent - move up
         return InteractionResult.SUCCESS;
     }
 
