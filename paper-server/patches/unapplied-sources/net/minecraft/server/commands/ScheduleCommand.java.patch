From 8970c8040a87bb9da1d22cabfd5dafb79924ed1f Mon Sep 17 00:00:00 2001
From: File <noreply+automated@papermc.io>
Date: Sun, 20 Apr 1997 06:37:42 -0700
Subject: [PATCH] paper File Patches


diff --git a/net/minecraft/server/commands/ScheduleCommand.java b/net/minecraft/server/commands/ScheduleCommand.java
index 90ebeddae219fe40747c715dc2f9e433496737e7..d545b48a31ca15a0c668f0d76906334fff43cdf3 100644
--- a/net/minecraft/server/commands/ScheduleCommand.java
+++ b/net/minecraft/server/commands/ScheduleCommand.java
@@ -32,7 +32,7 @@ public class ScheduleCommand {
     );
     private static final SimpleCommandExceptionType ERROR_MACRO = new SimpleCommandExceptionType(Component.translatableEscape("commands.schedule.macro"));
     private static final SuggestionProvider<CommandSourceStack> SUGGEST_SCHEDULE = (context, builder) -> SharedSuggestionProvider.suggest(
-        context.getSource().getServer().getWorldData().overworldData().getScheduledEvents().getEventsIds(), builder
+        context.getSource().getLevel().serverLevelData.getScheduledEvents().getEventsIds(), builder // Paper - Make schedule command per-world
     );
 
     public static void register(CommandDispatcher<CommandSourceStack> dispatcher) {
@@ -101,7 +101,7 @@ public class ScheduleCommand {
         } else {
             long l = source.getLevel().getGameTime() + time;
             ResourceLocation resourceLocation = function.getFirst();
-            TimerQueue<MinecraftServer> scheduledEvents = source.getServer().getWorldData().overworldData().getScheduledEvents();
+            TimerQueue<MinecraftServer> scheduledEvents = source.getLevel().serverLevelData.overworldData().getScheduledEvents(); // CraftBukkit - SPIGOT-6667: Use world specific function timer
             Optional<CommandFunction<CommandSourceStack>> optional = function.getSecond().left();
             if (optional.isPresent()) {
                 if (optional.get() instanceof MacroFunction) {
@@ -132,7 +132,7 @@ public class ScheduleCommand {
     }
 
     private static int remove(CommandSourceStack source, String function) throws CommandSyntaxException {
-        int i = source.getServer().getWorldData().overworldData().getScheduledEvents().remove(function);
+        int i = source.getLevel().serverLevelData.overworldData().getScheduledEvents().remove(function); // Paper - Make schedule command per-world
         if (i == 0) {
             throw ERROR_CANT_REMOVE.create(function);
         } else {
